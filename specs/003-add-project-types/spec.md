# Feature Specification: Integrate Project Types into Create Flow

**Feature Branch**: `003-add-project-types`  
**Created**: 2026-02-21  
**Status**: Draft  
**Input**: User description: "Integrate real project creation: add Project Type selection into CreateProjectModal (frontend/components/Start/CreateProjectModal.tsx) with a dropdown sourcing Project Types from getwrite-config/templates/project-types. On Create, call createProjectFromType (frontend/src/lib/models/project-creator.ts). Replace ResourceTree placeholder (frontend/components/Tree/ResourceTree.tsx) with resources generated by createProjectFromType."

## Clarifications

### Session 2026-02-21

- Q: Should Project Type templates accept JSON, YAML, or both? → A: JSON only.

## User Scenarios & Testing _(mandatory)_

### User Story 1 - Create Project from Project Type (Priority: P1)

As a user, I can open the Create Project modal, choose a Project Type from a dropdown populated from getwrite-config/templates/project-types, enter a project name, and click Create so that a new project scaffold is created using the selected Project Type and the UI immediately shows the generated resources in the Resource Tree.

**Why this priority**: Core UX enabling real projects and moving beyond placeholders.

**Independent Test**: Open Start → Create Project → select a Project Type → enter name → click Create. Verify a new project is created and the Resource Tree displays folders/resources declared by the Project Type.

**Acceptance Scenarios**:

1. **Given** the Create Project modal, **When** I open the Project Type dropdown, **Then** I see a list of project types sourced from getwrite-config/templates/project-types.
2. **Given** a selected Project Type and a valid project name, **When** I click Create, **Then** `createProjectFromType` is invoked and a new project scaffold appears and the app opens the new project with the Resource Tree populated with the declared folders and default resources.
3. **Given** an invalid or missing Project Type file, **When** I attempt to create, **Then** the UI shows a clear error message and prevents creation.

---

### User Story 2 - Resource Tree shows generated resources (Priority: P1)

As a user, after creating a project from a Project Type, I can see the real folder/resource structure in the Resource Tree instead of placeholder items.

**Why this priority**: Confirms the Create flow produces usable UI state for subsequent editing.

**Independent Test**: After creation, inspect the Resource Tree and open a sample resource; it should reflect the project-type declarations (names, special folders like Characters/Locations, and default resources).

**Acceptance Scenarios**:

1. **Given** a newly created project, **When** I open the Resource Tree, **Then** top-level folders appear in the order declared by the Project Type.
2. **Given** a default resource declared in the Project Type, **When** the project is created, **Then** that resource appears and is openable in the Work Area (placeholder content may be empty but the resource exists).

---

### User Story 3 - Project Type selection UX & validation (Priority: P2)

As a user, I can see human-friendly names and descriptions for Project Types in the dropdown and receive inline validation when a type has missing required fields.

**Why this priority**: Improves discoverability and prevents invalid creations.

**Independent Test**: Open dropdown and verify displayed metadata (name/description). Try creating with a deliberately malformed Project Type file and confirm validation prevents creation with a helpful message.

**Acceptance Scenarios**:

1. **Given** a Project Type with `name` and `description`, **When** viewing the dropdown, **Then** both are visible (name primary, description as secondary text).
2. **Given** a Project Type missing required fields, **When** selected and Create pressed, **Then** the UI prevents creation and shows which fields are invalid.

---

### Edge Cases

- Missing or unreadable project-type file → show specific error and fallback to a safe default (e.g., "No project types available").
- Duplicate folder names declared in a Project Type → normalize or reject with a validation error.
- Large number of Project Types → dropdown should be searchable or grouped for usability (UI-level behavior; implementation detail deferred).

## Requirements _(mandatory)_

### Functional Requirements

- **FR-001**: The Create Project modal MUST display a Project Type dropdown populated from getwrite-config/templates/project-types (local repo path).
- **FR-002**: The dropdown MUST display a human-friendly label and optional description for each Project Type.
- **FR-003**: When a user clicks Create, the frontend MUST call `createProjectFromType(projectName, projectTypeId)` in `frontend/src/lib/models/project-creator.ts` and use the returned scaffold to initialize the new project in the UI.
- **FR-004**: The Resource Tree (`frontend/components/Tree/ResourceTree.tsx`) MUST be able to render resources/folders produced by `createProjectFromType` and replace the placeholder content for newly-created projects.
- **FR-005**: The Create flow MUST validate Project Type files before creation and show user-friendly validation errors for missing/invalid declarations.
- **FR-006**: If project creation fails (IO error, validation, or creation routine), the UI MUST present a clear error and rollback any partial UI state.
- **FR-007**: The dropdown MUST refresh its list when the underlying project-types directory changes (at least on modal open or a manual refresh action).

### Key Entities

- **Project Type**: Declarative JSON file that includes `id`, `name`, `description`, `folders` (ordered), and optional `defaultResources` declarations.
- **Project**: The created project instance with root folders and resources derived from the Project Type.
- **Resource**: File-like item created from Project Type declarations. Attributes: name, type, folder path, metadata (optional).

## Success Criteria _(mandatory)_

### Measurable Outcomes

- **SC-001**: Users can create a project from a selected Project Type and see the declared top-level folders in the Resource Tree within 3 seconds of clicking Create (manual QA).
- **SC-002**: The Project Type list loads and displays at least 95% of types within 2 seconds on a typical dev machine when the modal opens (manual performance check).
- **SC-003**: For 100% of sample valid Project Types, creation produces a project whose Resource Tree top-level folders match the Project Type declaration (automated/unit test coverage for `createProjectFromType`).
- **SC-004**: On invalid Project Type files, the UI prevents creation and shows a validation message (manual QA and unit tests for validation routine).

## Non-Functional Requirements

- **Performance**: Listing and selecting Project Types is an interactive UI action; avoid blocking main thread during template parsing. For MVP, parsing on modal open is acceptable.
- **Reliability**: Creation routine should be idempotent for duplicate requests (guard against double-clicks) and rollback UI state on failure.
- **Security & Privacy**: Project Type files are local templates; ensure no execution of untrusted code (templates are data-only).

## Assumptions

- `getwrite-config/templates/project-types` is the authoritative local source for Project Type definitions (JSON files).
- `createProjectFromType` exists or will be implemented at `frontend/src/lib/models/project-creator.ts` and returns a shape the UI can render (folder/resource tree structure).
- This work is frontend-focused: file-system persistence and CLI scaffolding behavior are handled by existing or downstream model code invoked by `createProjectFromType`.

- The canonical data model for Projects/Folders/Resources is defined in `specs/002-define-data-models/data-model.md` and will be used by `createProjectFromType` and the Resource Tree rendering.

## Out Of Scope

- Elaborate Project Type editors — only reading and validating templates for creation is required.

## Acceptance Criteria (tests)

- AC-1: The Create Project modal lists available Project Types and shows labels/descriptions.
- AC-2: Selecting a valid Project Type and clicking Create invokes `createProjectFromType` and opens the new project with Resource Tree populated.
- AC-3: Invalid Project Type files are detected and prevent project creation with an explanatory message.
- AC-4: Resource Tree displays folders/resources declared by the Project Type in correct order.

## Deliverables

- UI changes to `frontend/components/Start/CreateProjectModal.tsx` to add Project Type dropdown and validation.
- Unit tests for parsing/validation of Project Type files and for `createProjectFromType` contract (mocked returns).
- Update `frontend/components/Tree/ResourceTree.tsx` to render scaffolded resources returned by `createProjectFromType` for newly-created projects.
- Spec quality checklist at `specs/003-add-project-types/checklists/requirements.md`.
